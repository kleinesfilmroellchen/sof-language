<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Functions - SOF Programming Language Documentation</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../Home.html">Home</a></li><li class="chapter-item expanded affix "><li class="part-title">Programmer documentation</li><li class="chapter-item expanded "><a href="../Guide.html"><strong aria-hidden="true">1.</strong> Guide</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Guide/Stack.html"><strong aria-hidden="true">1.1.</strong> The Stack</a></li><li class="chapter-item expanded "><a href="../Guide/Names-Errors.html"><strong aria-hidden="true">1.2.</strong> Names and Errors</a></li><li class="chapter-item expanded "><a href="../Guide/Functions.html" class="active"><strong aria-hidden="true">1.3.</strong> Functions</a></li><li class="chapter-item expanded "><a href="../Programming-conventions.html"><strong aria-hidden="true">1.4.</strong> Programming conventions</a></li></ol></li><li class="chapter-item expanded "><a href="../Standard-Library.html"><strong aria-hidden="true">2.</strong> Standard library</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Standard-Library/List.html"><strong aria-hidden="true">2.1.</strong> List methods</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.2.</strong> Float methods</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.3.</strong> Integer methods</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.4.</strong> String methods</div></li><li class="chapter-item expanded "><a href="../Standard-Library/math.html"><strong aria-hidden="true">2.5.</strong> math</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Language Reference</li><li class="chapter-item expanded "><a href="../Reference/Language-Specification.html"><strong aria-hidden="true">3.</strong> Language specification</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Reference/Types.html"><strong aria-hidden="true">3.1.</strong> Types</a></li><li class="chapter-item expanded "><a href="../Reference/PTs.html"><strong aria-hidden="true">3.2.</strong> Primitive Tokens</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Reference/PTs/Arithmetic-Logic.html"><strong aria-hidden="true">3.2.1.</strong> Arithmetic</a></li><li class="chapter-item expanded "><a href="../Reference/PTs/Control-flow.html"><strong aria-hidden="true">3.2.2.</strong> Control flow</a></li><li class="chapter-item expanded "><a href="../Reference/PTs/Stack.html"><strong aria-hidden="true">3.2.3.</strong> Stack &amp; Naming</a></li><li class="chapter-item expanded "><a href="../Reference/PTs/Functional.html"><strong aria-hidden="true">3.2.4.</strong> Functional</a></li><li class="chapter-item expanded "><a href="../Reference/PTs/Typing.html"><strong aria-hidden="true">3.2.5.</strong> Typing</a></li><li class="chapter-item expanded "><a href="../Reference/PTs/Modules.html"><strong aria-hidden="true">3.2.6.</strong> Modules</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../Reference/Builtin-functions.html"><strong aria-hidden="true">4.</strong> Built-in functions</a></li><li class="chapter-item expanded "><a href="../Reference/Module-System.html"><strong aria-hidden="true">5.</strong> Module system</a></li><li class="chapter-item expanded "><a href="../Reference/Language-Internals.html"><strong aria-hidden="true">6.</strong> Language internals</a></li><li class="chapter-item expanded "><a href="../Reference/Glossary.html"><strong aria-hidden="true">7.</strong> Glossary</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SOF Programming Language Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="its-a-bird-its-a-plane-no-wait---its-a-function"><a class="header" href="#its-a-bird-its-a-plane-no-wait---its-a-function">It's a bird! It's a plane! No wait - It's a function!</a></h1>
<p>Functions are essentially code blocks on steroids. They can't do anything more or less, they are just safer and more convenient. To create a function, this pattern is generally used:</p>
<pre><code class="language-sof"># create the function
{ 3 + return } 1 function addThree globaldef
# and call it
1 addThree : writeln # 4
</code></pre>
<p>The important bit is the primitive token (keyword) <code>function</code>. It takes in a piece of executable SOF code, a &quot;Callable&quot;, as well as an argument count, which is 1 in this case. The code for the function here is a simple code block, the only way you can specify a Callable literally. Code block data behaves like any other data, it lives on the stack and can be assigned a name. Its superpower is <em>delayed execution</em>, that is, the SOF instructions you place inside it are not executed immediately, they are stored, to be run later. In this case, unlike the <code>if</code> and <code>ifelse</code> commands you saw earlier, we don't even use the stored code directly, instead, we use it as the logic of a newly created function. But the function itself is also just a Callable, some data, now sitting on the stack. To use it repeatedly from anywhere, we must <code>def</code> it like any other variable and give it a name. We use the <code>globaldef</code> in this case, which will always <code>def</code> globally (duh) (Python programmers: compare this to the <code>global</code> keyword). This pattern is SOF convention and allows you to define functions globally even inside other functions and classes.</p>
<p>We can now call the function, like we called the variables beforehand. But behold! This time around, we don't simply retrieve the Identifier's &quot;value&quot; with <code>.</code>. That would be the function itself again, which we want to call! For this reason, the double-call operator <code>:</code> exists. It simply executes two calls, the first time retrieving the function, the second time executing it. It is both more performant and more compact than <code>. .</code>, but identical in function.</p>
<p>Now, what happens when we call the function? If you know any programming language, you know that functions (or methods, procedures, lambdas or whatever they're called) can recieve one or more arguments. SOF, of course, is no different. If you know hardware/assembly-level programming, this may sound familiar: Arguments to an SOF function are expected to be on the stack. The function definition specifies the number of arguments, and SOF places a &quot;stack protector&quot; under all of a function's arguments. This means that a function's body cannot change anything that is on the stack, except for its arguments, of course. Also, anything that is on the stack when the function exits will be deleted, up to this &quot;stack protector&quot;. Think of the stack protector as a specially-marked return address in assembler. The function cannot mess with the caller's stack and cannot clobber it. You can absolutely be sure how many elements from the stack are consumed, according to the function's argument count.</p>
<p>The code block looks familiar, but it now uses the new-fangled operation <code>return</code>. This will break out of the function body instantly and return the topmost value on the stack from the function. Alternatively, you can use the <code>return:nothing</code> PT, which will end the function without returning anything. This is the default behavior when the function's end is reached without a <code>return</code>. The return value is placed onto the stack, obviously. In the example we use it as an argument to <code>writeln</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../Guide/Names-Errors.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../Programming-conventions.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../Guide/Names-Errors.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../Programming-conventions.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
